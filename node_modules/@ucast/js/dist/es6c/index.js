"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@ucast/core");function t(r,t,e){for(let o=0,n=r.length;o<n;o++)if(0===e(r[o],t))return!0;return!1}function e(r,t){return Array.isArray(r)&&Number.isNaN(Number(t))}function o(r,t,o){if(!e(r,t))return o(r,t);let n=[];for(let e=0;e<r.length;e++){const s=o(r[e],t);void 0!==s&&(n=n.concat(s))}return n}function n(r){return(t,e,o)=>{const n=o.get(e,t.field);return Array.isArray(n)?n.some(e=>r(t,e,o)):r(t,n,o)}}const s=Object.hasOwn||Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),u=(r,t)=>r[t];function c(r,t,e){const o=t.lastIndexOf(".");return-1===o?[r,t]:[e(r,t.slice(0,o)),t.slice(o+1)]}function p(t,e,n=u){if(e===r.ITSELF)return t;if(!t)throw new Error(`Unable to get field "${e}" out of ${String(t)}.`);return function(r,t,e){if(-1===t.indexOf("."))return o(r,t,e);const n=t.split(".");let s=r;for(let r=0,t=n.length;r<t;r++)if(s=o(s,n[r],e),!s||"object"!=typeof s)return r<t-1?void 0:s;return s}(t,e,n)}function i(r,t){return r===t?0:r>t?1:-1}function x(t,e={}){return r.createInterpreter(t,Object.assign({get:p,compare:i},e))}const f=(r,t,{interpret:e})=>r.value.some(r=>e(r,t)),a=(r,t,e)=>!f(r,t,e),l=(r,t,{interpret:e})=>r.value.every(r=>e(r,t)),b=(r,t,{interpret:e})=>!e(r.value[0],t),g=(r,e,{compare:o,get:n})=>{const s=n(e,r.field);return Array.isArray(s)&&!Array.isArray(r.value)?t(s,r.value,o):0===o(s,r.value)},y=(r,t,e)=>!g(r,t,e),m=n((r,t,e)=>{const o=e.compare(t,r.value);return 0===o||-1===o}),j=n((r,t,e)=>-1===e.compare(t,r.value)),d=n((r,t,e)=>1===e.compare(t,r.value)),A=n((r,t,e)=>{const o=e.compare(t,r.value);return 0===o||1===o}),O=(t,o,{get:n})=>{if(t.field===r.ITSELF)return void 0!==o;const[u,p]=c(o,t.field,n),i=r=>null==r?Boolean(r)===t.value:s(r,p)===t.value;return e(u,p)?u.some(i):i(u)},v=n((r,t)=>"number"==typeof t&&t%r.value[0]===r.value[1]),_=(t,o,{get:n})=>{const[s,u]=c(o,t.field,n),p=r=>{const e=n(r,u);return Array.isArray(e)&&e.length===t.value};return t.field!==r.ITSELF&&e(s,u)?s.some(p):p(s)},h=n((r,t)=>"string"==typeof t&&r.value.test(t)),w=n((r,e,{compare:o})=>t(r.value,e,o)),q=(r,t,e)=>!w(r,t,e),M=(r,e,{compare:o,get:n})=>{const s=n(e,r.field);return Array.isArray(s)&&r.value.every(r=>t(s,r,o))},N=(r,t,{interpret:e,get:o})=>{const n=o(t,r.field);return Array.isArray(n)&&n.some(t=>e(r.value,t))},$=(r,t)=>r.value.call(t);var z=Object.freeze({__proto__:null,or:f,nor:a,and:l,not:b,eq:g,ne:y,lte:m,lt:j,gt:d,gte:A,exists:O,mod:v,size:_,regex:h,within:w,nin:q,all:M,elemMatch:N,where:$});const B=Object.assign({},z,{in:w}),E=x(B);exports.all=M,exports.allInterpreters=B,exports.and=l,exports.compare=i,exports.createGetter=function(r){return(t,e)=>p(t,e,r)},exports.createJsInterpreter=x,exports.elemMatch=N,exports.eq=g,exports.exists=O,exports.getObjectField=p,exports.getObjectFieldCursor=c,exports.gt=d,exports.gte=A,exports.interpret=E,exports.lt=j,exports.lte=m,exports.mod=v,exports.ne=y,exports.nin=q,exports.nor=a,exports.not=b,exports.or=f,exports.regex=h,exports.size=_,exports.where=$,exports.within=w;
//# sourceMappingURL=index.js.map
